<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Content Analysis</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Custom Animations from React component's style jsx */
        @keyframes bounce-slow {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .animate-bounce-slow {
            animation: bounce-slow 6s ease-in-out infinite;
        }
        .animate-bounce-slow-delayed {
            animation: bounce-slow 6s ease-in-out infinite;
            animation-delay: 1.5s;
        }
        .animate-float {
            animation: float 8s ease-in-out infinite;
        }
        .animate-float-reverse {
            animation: float 10s ease-in-out infinite reverse;
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-950 via-purple-900 to-pink-800 text-white overflow-hidden relative">

    <!-- Background Decorations -->
    <div class="absolute top-0 left-0 w-full h-full pointer-events-none z-0">
        <!-- Floating 3D Icons -->
        <div class="absolute top-1/4 left-10 animate-bounce-slow">
            <svg class="w-16 h-16 opacity-20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M2 17L12 22L22 17" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M2 12L12 17L22 12" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
        </div>
        <div class="absolute bottom-10 right-10 animate-bounce-slow-delayed">
            <svg class="w-20 h-20 opacity-20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" stroke="white" stroke-width="2" />
                <path d="M12 8V12L15 15" stroke="white" stroke-width="2" stroke-linecap="round" />
            </svg>
        </div>
        <div class="absolute top-1/2 right-20 animate-float">
            <svg class="w-12 h-12 opacity-10" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="3" y="3" width="18" height="18" rx="2" stroke="white" stroke-width="2" />
                <path d="M3 9H21" stroke="white" stroke-width="2" />
                <path d="M12 15L16 19" stroke="white" stroke-width="2" stroke-linecap="round" />
                <path d="M12 15L8 19" stroke="white" stroke-width="2" stroke-linecap="round" />
            </svg>
        </div>
        <div class="absolute top-20 left-1/3 animate-float-reverse">
            <svg class="w-14 h-14 opacity-10" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="white" stroke-width="2" />
                <path d="M8 14L11 11L16 16" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
        </div>
    </div>

    <!-- Main Content -->
    <div class="relative z-10 min-h-screen flex flex-col items-center justify-center p-4">
        <div class="text-center mb-10">
            <div class="flex items-center justify-center gap-3 mb-4">
                <svg class="w-10 h-10 text-yellow-300" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M22 6.5C22 5.11929 20.8807 4 19.5 4H4.5C3.11929 4 2 5.11929 2 6.5C2 7.88071 3.11929 9 4.5 9H19.5C20.8807 9 22 7.88071 22 6.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M12 12L12 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M9 15L12 18L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <h1 class="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 via-pink-300 to-purple-300">
                    Email Content Analysis
                </h1>
            </div>
            <p class="text-gray-300 max-w-md mx-auto">
                Paste your email content here and let our system analyze it for suspicious material.
            </p>
        </div>

        <div class="w-full max-w-lg bg-black/30 backdrop-blur-sm rounded-xl shadow-2xl p-6 border border-white/10 transform transition-all hover:scale-[1.01] hover:shadow-purple-500/20 duration-300">
            <textarea
                id="emailTextarea"
                placeholder="Paste your email content here..."
                rows="6"
                class="w-full p-4 rounded-lg bg-white/10 border border-white/20 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none"
            ></textarea>

            <button
                id="detectSpamButton"
                class="mt-4 w-full py-3 px-6 rounded-lg font-medium transition-all duration-300 flex items-center justify-center gap-2 bg-gray-600 cursor-not-allowed"
                disabled
            >
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <span>Analyze Content</span>
            </button>

            <div id="resultDisplay" class="hidden mt-6 p-4 rounded-lg border animate-fade-in">
                <h3 id="resultTitle" class="font-semibold text-lg"></h3>
                <p id="resultMessage" class="mt-1 text-sm text-gray-300"></p>
            </div>
        </div>

        <div class="mt-12 text-center text-gray-400 text-sm">
            <p>Powered by AI-based unwanted content detection</p>
        </div>
    </div>

    <script>
        // DOM elements references
        const emailTextarea = document.getElementById('emailTextarea');
        const detectSpamButton = document.getElementById('detectSpamButton');
        const resultDisplay = document.getElementById('resultDisplay');
        const resultTitle = document.getElementById('resultTitle');
        const resultMessage = document.getElementById('resultMessage');

        // State variables (equivalent to React's useState)
        let emailText = "";
        let result = null;
        let loading = false;

        // Function to update the UI based on state
        function updateUI() {
            // Update button state and text
            if (loading) {
                detectSpamButton.disabled = true;
                detectSpamButton.classList.remove('bg-gradient-to-r', 'from-purple-600', 'to-pink-600', 'hover:from-purple-500', 'hover:to-pink-500', 'shadow-lg', 'hover:shadow-purple-600/50', 'transform', 'hover:-translate-y-0.5');
                detectSpamButton.classList.add('bg-gray-600', 'cursor-not-allowed');
                detectSpamButton.innerHTML = `
                    <svg class="animate-spin h-5 w-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Analyzing...
                `;
            } else {
                detectSpamButton.disabled = !emailText.trim();
                if (emailText.trim()) {
                    detectSpamButton.classList.remove('bg-gray-600', 'cursor-not-allowed');
                    detectSpamButton.classList.add('bg-gradient-to-r', 'from-purple-600', 'to-pink-600', 'hover:from-purple-500', 'hover:to-pink-500', 'shadow-lg', 'hover:shadow-purple-600/50', 'transform', 'hover:-translate-y-0.5');
                } else {
                    detectSpamButton.classList.remove('bg-gradient-to-r', 'from-purple-600', 'to-pink-600', 'hover:from-purple-500', 'hover:to-pink-500', 'shadow-lg', 'hover:shadow-purple-600/50', 'transform', 'hover:-translate-y-0.5');
                    detectSpamButton.classList.add('bg-gray-600', 'cursor-not-allowed');
                }
                detectSpamButton.innerHTML = `
                    <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <span>Analyze Content</span>
                `;
            }

            // Update result display
            if (result) {
                resultDisplay.classList.remove('hidden');
                // Remove previous classes
                resultDisplay.classList.remove('bg-red-900/30', 'border-red-700', 'bg-green-900/30', 'border-green-700');

                if (result === "spam") {
                    resultDisplay.classList.add('bg-red-900/30', 'border-red-700');
                    resultTitle.textContent = "Suspicious Content Found!";
                    resultMessage.textContent = "The system found suspicious patterns in this email. Be cautious.";
                } else if (result === "not-spam") {
                    resultDisplay.classList.add('bg-green-900/30', 'border-green-700');
                    resultTitle.textContent = "This email seems safe.";
                    resultMessage.textContent = "No unwanted patterns detected in this email content.";
                } else { // Error state (e.g., network error)
                    resultDisplay.classList.add('bg-red-900/30', 'border-red-700');
                    resultTitle.textContent = "Error!";
                    resultMessage.textContent = "Could not connect to the content analysis service. Please try again later.";
                }
            } else {
                resultDisplay.classList.add('hidden'); // Hide result if not available
            }
        }

        // Event handler for textarea input
        emailTextarea.oninput = (e) => {
            emailText = e.target.value;
            updateUI(); // Update button state
        };

        // Event handler for Analyze Content button click
        detectSpamButton.onclick = async () => {
            if (!emailText.trim()) return;

            loading = true;
            result = null; // Clear previous result
            updateUI(); // Update UI to loading state

            try {
                // Connection Point: This line sends a request to the Flask backend
                // Ensure this URL (IP and Port) matches the address your app.py is running on.
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ emailText: emailText })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                result = data.prediction;
            } catch (error) {
                // Error handling: If there's a network issue or an error from the server
                console.error("Error analyzing content:", error);
                result = "error";
            } finally {
                loading = false;
                updateUI(); // Final UI update
            }
        };

        // Initial UI update on page load
        document.addEventListener('DOMContentLoaded', updateUI);
    </script>
</body>
</html>
